<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="Citytours - Premium site template for city tours agencies, transfers and tickets.">
    <meta name="author" content="Ansonika">
    <title>CITY TOURS - City tours and travel site template by Ansonika</title>

    <!-- Favicons-->
    <link rel="shortcut icon" href="img/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon" type="image/x-icon" href="img/apple-touch-icon-57x57-precomposed.png">
    <link rel="apple-touch-icon" type="image/x-icon" sizes="72x72" href="img/apple-touch-icon-72x72-precomposed.png">
    <link rel="apple-touch-icon" type="image/x-icon" sizes="114x114" href="img/apple-touch-icon-114x114-precomposed.png">
    <link rel="apple-touch-icon" type="image/x-icon" sizes="144x144" href="img/apple-touch-icon-144x144-precomposed.png">

    <!-- GOOGLE WEB FONT -->
    <link href="https://fonts.googleapis.com/css?family=Gochi+Hand|Montserrat:300,400,700" rel="stylesheet">

    <!-- COMMON CSS -->
	<link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">
	<link href="css/vendors.css" rel="stylesheet">
	
	<!-- CUSTOM CSS -->
	<link href="css/custom.css" rel="stylesheet">

</head>

<body>

	<div id="preloader">
		<div class="sk-spinner sk-spinner-wave">
			<div class="sk-rect1"></div>
			<div class="sk-rect2"></div>
			<div class="sk-rect3"></div>
			<div class="sk-rect4"></div>
			<div class="sk-rect5"></div>
		</div>
	</div>
	<!-- End Preload -->

	<div class="layer"></div>
	<!-- Mobile menu overlay mask -->

	<!--======================== Header========================== -->
	<div id="header" th:include="include-common-top::include-common-top"></div>
	<!--======================== End Header======================== -->
	<section id="hero_2">
		<div class="intro_title">
			<h1>Place your order</h1>
			<div class="bs-wizard row">

				<div class="col-4 bs-wizard-step complete">
					<div class="text-center bs-wizard-stepnum">Your cart</div>
					<div class="progress">
						<div class="progress-bar"></div>
					</div>
					<a href="cart_hotel.html" class="bs-wizard-dot"></a>
				</div>

				<div class="col-4 bs-wizard-step active">
					<div class="text-center bs-wizard-stepnum">Your details</div>
					<div class="progress">
						<div class="progress-bar"></div>
					</div>
					<a href="#" class="bs-wizard-dot"></a>
				</div>

				<div class="col-4 bs-wizard-step disabled">
					<div class="text-center bs-wizard-stepnum">Finish!</div>
					<div class="progress">
						<div class="progress-bar"></div>
					</div>
					<a href="confirmation_hotel.html" class="bs-wizard-dot"></a>
				</div>

			</div>
			<!-- End bs-wizard -->
		</div>
		<!-- End intro-title -->
	</section>
	<!-- End Section hero_2 -->
	
	<main>
		<div id="position">
			<div class="container">
				<ul>
					<li><a href="#">Home</a>
					</li>
					<li><a href="#">Category</a>
					</li>
					<li>Page active</li>
				</ul>
			</div>
		</div>
		<!-- End position -->

<!-- ------------------------------- -->
<!-- Start  Payment Form                    	티켓 결제 액션-->
		<form th:object="${rsPInfo}" name="f" method="POST" >
		<input type="hidden" name="userId" th:value="${session.loginUser.userId}">
		<div class="container margin_60">
			<div class="row">
				<div class="col-lg-8">
					<div class="form_title">
						<h3><strong>1</strong>예약 확인</h3>
						<br><br>
						<h4 th:text="${session.ticket.tiTitle}"></h4>
					</div>
					<div class="step">
						<div class="row">
							<div class="col-sm-5">
								<div class="form-group">
									<label>예약자명</label>
									<input type="text" class="form-control" name="rsPName" th:value="${session.loginUser.name}">
								</div>
							</div>
							<div class="col-sm-5">
								<div class="form-group">
									<label>휴대폰 번호</label>
									<input type="text" class="form-control" name="rsPPhone" th:value="${session.loginUser.phone}">
								</div>
							</div>
						</div>
						<div class="row">
							<div class="col-sm-5">
								<div class="form-group">
									<label>Email</label>
									<input type="email" class="form-control" name="rsPEmail" th:value="${session.loginUser.email}">
								</div>
							</div>
							
						</div>
					</div>
					
					<div class="form_title">
						<h3><strong>2</strong>요청 사항</h3>
					</div>
					<div class="step">
						<div class="row">
							<div class="col-sm-6">
								<div class="form-group">
									<label>입력창</label>
									<input type ="text" class="form-control" name="pMsg">
								</div>
							</div>
							<!-- 아래 쪽 삭제하기 -->
							<div class="col-sm-6">
								<div class="form-group">
									<label>결제 수단</label>
									<!-- radio -->
								<select id="pMethod" name="pMethod">
								  <option value="" selected> 선택해주세요</option>
								  <option value="1">카드결제</option>
								  <option value="2">현장결제</option>
								</select>
								</div>
							</div>
						</div>
						<div class="row">
							<div class="col-sm-6">
								<div class="form-group">
									<label>Email</label>
									<input type ="text" id="email_booking" name="email_booking" class="form-control">
								</div>
							</div>
							<div class="col-sm-6">
								<div class="form-group">
									<label>Confirm email</label>
									<input type="email" id="email_booking_2" name="email_booking_2" class="form-control">
								</div>
							</div>
						</div>
						<div class="row">
							<div class="col-sm-6">
								<div class="form-group">
									<label>Telephone</label>
									<input type="text" id="telephone_booking" name="telephone_booking" class="form-control">
								</div>
							</div>
						</div>
					</div>
				</div>
													<!--------------------------결제창 시작-------------------------------->
			<aside class="col-lg-4">
					<div class="box_style_1">
						<h3 class="inner">- Summary -</h3>
						<table class="table table_summary">
							<tbody>
								<tr>
									<td>
										예약 날짜
									</td>
									<td class="text-right" th:text="${#dates.format(session.payment.pStartDate, 'yyyy-MM-dd')}">
										10 April 2015
									</td>
								</tr>
								
								<tr>
									<td>
										티켓 가격 (개)
									</td>
									<td class="text-right" th:text="${session.ticket.tiPrice}">
										$34
									</td>
								</tr>
							
								<tr>
									<td>
										수량
									</td>
									<td class="text-right" th:text="${session.payment.pQty}">
										2
									</td>
								</tr>
								
								<tr class="total">
									<td>
										총 금액
									</td>
									<td class="text-right" th:text="${session.payment.pPrice}">
										$154
									</td>
								</tr>
							</tbody>
						</table>
						<button class = "btn_full" type="button" onclick="ticket_payment_complete_action()">결제하기</button>
						<a class="btn_full_outline" href="single_hotel.html"><i class="icon-right"></i> Modify your search</a>
					  </div>
					
				</aside>
	<!-- ------------------------결제창----------------------------------------------------------------------------------------------------------->
		
			</div>
			</div>
	<!-------------------------------------------------------------------------------------------------------------------------------------------->
					
		<!--  추가 정보 폼 
			<div class="row">
				<div class="col-lg-8 add_bottom_15">
					
					<div id="policy">
						<h4>Cancellation policy</h4>
						<div class="form-group">
							<label>
								<input type="checkbox" name="policy_terms" id="policy_terms">I accept terms and conditions and general policy.</label>
						</div>
						<a href="ticket-payment-confirmation.html" class="btn_1 green medium">결제 하기</a>
					</div>
				</div>
			</div>
		-->
		</form>
		<!-- End Form -->
		<!--End container -->
	</main>
	<!-- End main -->
	<!--========================= footer ========================-->
	<footer class="revealed">
		<div id="footer" th:include="include-common-bottom::include-common-bottom"></div>
	</footer>
		<!-- End container -->
	<!--========================= End footer ========================-->

	<div id="toTop"></div><!-- Back to top button -->
	
	<!-- Search Menu -->
	<div class="search-overlay-menu">
		<span class="search-overlay-close"><i class="icon_set_1_icon-77"></i></span>
		<form role="search" id="searchform" method="get">
			<input value="" name="q" type="search" placeholder="Search..." />
			<button type="submit"><i class="icon_set_1_icon-78"></i>
			</button>
		</form>
	</div><!-- End Search Menu -->
	
	<!-- Sign In Popup -->
	<div id="sign-in-dialog" class="zoom-anim-dialog mfp-hide">
		<div class="small-dialog-header">
			<h3>Sign In</h3>
		</div>
		<form>
			<div class="sign-in-wrapper">
				<a href="#0" class="social_bt facebook">Login with Facebook</a>
				<a href="#0" class="social_bt google">Login with Google</a>
				<div class="divider"><span>Or</span></div>
				<div class="form-group">
					<label>Email</label>
					<input type="email" class="form-control" name="email" id="email">
					<i class="icon_mail_alt"></i>
				</div>
				<div class="form-group">
					<label>Password</label>
					<input type="password" class="form-control" name="password" id="password" value="">
					<i class="icon_lock_alt"></i>
				</div>
				<div class="clearfix add_bottom_15">
					<div class="checkboxes float-left">
						<input id="remember-me" type="checkbox" name="check">
						<label for="remember-me">Remember Me</label>
					</div>
					<div class="float-right"><a id="forgot" href="javascript:void(0);">Forgot Password?</a></div>
				</div>
				<div class="text-center"><input type="submit" value="Log In" class="btn_login"></div>
				<div class="text-center">
					Don’t have an account? <a href="javascript:void(0);">Sign up</a>
				</div>
				<div id="forgot_pw">
					<div class="form-group">
						<label>Please confirm login email below</label>
						<input type="email" class="form-control" name="email_forgot" id="email_forgot">
						<i class="icon_mail_alt"></i>
					</div>
					<p>You will receive an email containing a link allowing you to reset your password to a new preferred one.</p>
					<div class="text-center"><input type="submit" value="Reset Password" class="btn_1"></div>
				</div>
			</div>
		</form>
		<!--form -->
	</div>
	<!-- /Sign In Popup -->

	<!-- Common scripts -->
	<script src="js/jquery-2.2.4.min.js"></script>
	<script src="js/common_scripts_min.js"></script>
	<script src="js/functions.js"></script>
	
	<!-- Check box and radio style iCheck -->
	<script>
		$('input').iCheck({
		   checkboxClass: 'icheckbox_square-grey',
		   radioClass: 'iradio_square-grey'
		 });
	</script>
	
		<!-- portone -->
	<!-- iamport.payment.js -->
	<script type="text/javascript" src="https://cdn.iamport.kr/js/iamport.payment-1.2.0.js"></script>
	<!-- <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.24.0/moment.min.js"></script> -->
	<script>
		console.log("[[${session.payment}]]");
	
      function ticket_payment_complete_action() {
    	  var IMP = window.IMP; 
          IMP.init("imp43548145"); 
          
          var pMethod = "";
          if($("#pMethod").val() == 1) {
        	  pMethod = "card";
          }
          
    	  /*[[${session.payment.pPrice}]]", */
          IMP.request_pay({
              pg : "html5_inicis", // KG이니시스 일반결제창 호출(상점아이디 MID-a 적용) // 카드, 페이 결제 다 되는데 나눌지 말지 고민중
              pay_method : pMethod,
              merchant_uid: "[[${session.payment.pNo}]]", 
              name : "[[${session.ticket.tiTitle}]]",
              amount : 100, // 테스트 용으로 100원만 결제 되게 해둠 
              buyer_email : "[[${session.loginUser.email}]]",
              buyer_name : "[[${session.loginUser.name}]]",
              buyer_tel : "[[${session.loginUser.phone}]]",
              buyer_addr : "[[${session.loginUser.address}]]",
          }, function (rsp) { // callback
        	  
        	  console.log(rsp);
        	  
              if (rsp.success) {
                  document.f.action='ticket-payment-complete-action';
                  document.f.submit();
              } else {
                  console.log(rsp);
              }
          });
      }
	
	
	</script>


</body>

</html>